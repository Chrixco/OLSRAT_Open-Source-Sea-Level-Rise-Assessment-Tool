# -*- coding: utf-8 -*-
"""
/***************************************************************************
 SlrVulnerabilityMapperProvider
    QGIS Processing Provider for the SLR Vulnerability Toolkit
 Generated by QGIS Plugin Builder
                              -------------------
        begin                : 2025-08-17
        copyright            : (C) 2025
        author               : Christian Xavier Corral Burau
        email                : christianxcorral@gmail.com
 ***************************************************************************/

/***************************************************************************
 *                                                                         *
 *   This program is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU General Public License as published by  *
 *   the Free Software Foundation; either version 2 of the License, or     *
 *   (at your option) any later version.                                   *
 *                                                                         *
 ***************************************************************************/
"""

import os
from qgis.core import QgsProcessingProvider
from qgis.PyQt.QtGui import QIcon


def _get_icon_path():
    """Get absolute path to plugin icon"""
    return os.path.join(os.path.dirname(__file__), "Icons", "256.png")


# Export PLUGIN_ICON at module level for use by main plugin file
PLUGIN_ICON = QIcon(_get_icon_path())

# Import all algorithms explicitly
from .scripts.alg_open_gui import AlgOpenGui
from .scripts.alg_fetch_dem import AlgFetchDEM
from .scripts.alg_inundation import AlgInundation
from .scripts.alg_svi import AlgSVI
from .scripts.alg_point_inundation import AlgPointFlooding
from .scripts.alg_point_flood_heatmap import AlgPointFloodHeatmap
from .scripts.alg_slope import AlgSlope
from .scripts.alg_hillshade import AlgHillshade
from .scripts.alg_aspect import AlgAspect
from .scripts.alg_flood_scenario_generator import AlgIPCCScenarios
from .scripts.alg_reproject_vector import AlgReprojectVector
from .scripts.alg_vector_to_raster import AlgVectorToRaster
from .scripts.alg_raster_to_vector import AlgRasterToVector
from .scripts.alg_dem_flood_scenario import DemFloodScenarioAlgorithm
from .scripts.alg_dem_flood_scenario_codec import DemFloodScenarioAlgorithmWithReturnPeriod
from .scripts.alg_inundation_heatmap_viz import AlgInundationHeatmapViz
from .scripts.alg_area_comparison import AlgAreaComparison
from .scripts.alg_feature_comparison import AlgFeatureComparison
from .scripts.alg_population_impact import AlgPopulationImpact


class SlrVulnerabilityMapperProvider(QgsProcessingProvider):
    """
    Processing provider for the SLR Vulnerability Toolkit
    """

    def __init__(self):
        super().__init__()

    def loadAlgorithms(self, config=None):
        """
        Add all algorithms to the provider
        """
        # Quick Access - GUI Launcher (at the top!)
        self.addAlgorithm(AlgOpenGui())

        # Data Preparation
        self.addAlgorithm(AlgFetchDEM())
        self.addAlgorithm(AlgReprojectVector())
        self.addAlgorithm(AlgVectorToRaster())
        self.addAlgorithm(AlgRasterToVector())

        # Flood Exposure
        self.addAlgorithm(DemFloodScenarioAlgorithm())
        self.addAlgorithm(DemFloodScenarioAlgorithmWithReturnPeriod())
        self.addAlgorithm(AlgInundation())
        self.addAlgorithm(AlgPointFlooding())
        self.addAlgorithm(AlgPointFloodHeatmap())
        self.addAlgorithm(AlgIPCCScenarios())

        # Social Analysis
        self.addAlgorithm(AlgSVI())

        # Terrain Analysis
        self.addAlgorithm(AlgSlope())
        self.addAlgorithm(AlgHillshade())
        self.addAlgorithm(AlgAspect())

        # Visualization & Analysis
        self.addAlgorithm(AlgInundationHeatmapViz())
        self.addAlgorithm(AlgAreaComparison())
        self.addAlgorithm(AlgFeatureComparison())
        self.addAlgorithm(AlgPopulationImpact())

    def id(self):
        """
        Unique provider id (lowercase, no spaces)
        """
        return "slr_vulnerability"

    def name(self):
        """
        Short name shown in the Processing Toolbox
        """
        return self.tr("SLR Vulnerability")

    def longName(self):
        """
        Long descriptive name shown in Processing Provider list
        """
        return self.tr("SLR Vulnerability Toolkit")

    def icon(self):
        """
        Provider icon
        """
        try:
            return QIcon(":/slr_vm/Icons/256.png")
        except Exception:
            return QIcon()
